import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.svm import SVC
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

# 데이터 읽기
file_path = "C:/Users/wlsgh/Downloads/iris.csv"  # 경로를 본인의 환경에 맞게 수정
df = pd.read_csv(file_path)

# 데이터 확인
print("데이터프레임의 처음 5행:")
print(df.head())
print("\n열 이름:")
print(df.columns)

# 결측치 확인
print("\n결측치 개수:")
print(df.isnull().sum())

# 특성과 타겟 분리
X = df[['SepalLength', 'SepalWidth', 'PetalLength', 'PetalWidth']]
y = df['Name']

# 데이터 분할
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 의사결정나무
dt_model = DecisionTreeClassifier(random_state=42)
dt_model.fit(X_train, y_train)
dt_pred = dt_model.predict(X_test)
print("\n의사결정나무 정확도:", accuracy_score(y_test, dt_pred))

# 랜덤 포레스트
rf_model = RandomForestClassifier(random_state=42)
rf_model.fit(X_train, y_train)
rf_pred = rf_model.predict(X_test)
print("랜덤 포레스트 정확도:", accuracy_score(y_test, rf_pred))

# SVM
svm_model = SVC(random_state=42)
svm_model.fit(X_train, y_train)
svm_pred = svm_model.predict(X_test)
print("SVM 정확도:", accuracy_score(y_test, svm_pred))

# 로지스틱 회귀
lr_model = LogisticRegression(max_iter=200, random_state=42)
lr_model.fit(X_train, y_train)
lr_pred = lr_model.predict(X_test)
print("로지스틱 회귀 정확도:", accuracy_score(y_test, lr_pred))
